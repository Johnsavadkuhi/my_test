<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>React Fiber Animation (Flow Enhanced)</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f3f4f6;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
      padding-top: 40px;
      overflow: hidden;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 20px;
      transition: color 0.5s ease;
    }

    .tree {
      position: relative;
      width: 500px;
      height: 340px;
      background: #fff;
      border: 2px solid #e5e7eb;
      border-radius: 16px;
      box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.05);
      overflow: hidden;
    }

    .node {
      position: absolute;
      width: 110px;
      height: 60px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      border: 2px solid #ccc;
      transition: all 0.8s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .render {
      background-color: #dbeafe; /* blue */
    }

    .commit {
      background-color: #fef3c7; /* yellow */
    }

    .highlight {
      background-color: #a7f3d0 !important; /* green */
      transform: scale(1.15);
      box-shadow: 0 0 20px #6ee7b7;
    }

    .pulse {
      animation: pulse 1s infinite alternate;
    }

    @keyframes pulse {
      0% { transform: scale(1); box-shadow: 0 0 5px #6ee7b7; }
      100% { transform: scale(1.2); box-shadow: 0 0 20px #34d399; }
    }

    .info-box {
      margin-top: 20px;
      width: 500px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      padding: 12px 16px;
      font-size: 14px;
      color: #374151;
      transition: all 0.5s ease;
    }

    /* Arrow Lines */
    .arrow {
      position: absolute;
      width: 2px;
      background-color: #ccc;
      overflow: hidden;
    }
    .arrow.down {
      height: 60px;
    }

    /* Flow Animation */
    .flow::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to bottom, #60a5fa, transparent);
      opacity: 0;
      animation: flowDown 2s linear infinite;
    }

    @keyframes flowDown {
      0% { transform: translateY(-100%); opacity: 0.3; }
      50% { opacity: 1; }
      100% { transform: translateY(100%); opacity: 0.3; }
    }
  </style>
</head>
<body>
  <h1 id="phaseTitle">React Fiber Tree Animation (Render Phase)</h1>

  <div class="tree">
    <div id="app" class="node render" style="left:200px; top:30px;">App</div>
    <div id="header" class="node render" style="left:60px; top:130px;">Header</div>
    <div id="main" class="node render" style="left:350px; top:130px;">Main</div>
    <div id="animatedBox" class="node render" style="left:350px; top:230px;">AnimatedBox</div>

    <!-- arrows -->
    <div id="arrow1" class="arrow down" style="left:250px; top:70px;"></div>
    <div id="arrow2" class="arrow down" style="left:110px; top:170px;"></div>
    <div id="arrow3" class="arrow down" style="left:400px; top:170px;"></div>
  </div>

  <div class="info-box" id="infoBox">
    ðŸ§© <b>Render Phase:</b> React walks the Fiber tree, comparing new and old virtual DOM elements. Work can be paused or split into chunks.
  </div>

  <script>
    const phaseTitle = document.getElementById('phaseTitle');
    const infoBox = document.getElementById('infoBox');
    const nodes = document.querySelectorAll('.node');
    const animatedBox = document.getElementById('animatedBox');
    const arrows = document.querySelectorAll('.arrow');

    let phase = 'render';

    setInterval(() => {
      if (phase === 'render') {
        // Switch to commit phase
        phase = 'commit';
        phaseTitle.textContent = 'React Fiber Tree Animation (Commit Phase)';
        phaseTitle.style.color = '#065f46';
        infoBox.innerHTML =
          'âš¡ <b>Commit Phase:</b> React applies DOM and style changes. This phase is fast and non-interruptible.';
        infoBox.style.backgroundColor = '#ecfccb';

        nodes.forEach(node => {
          node.classList.remove('render');
          node.classList.add('commit');
        });

        animatedBox.classList.add('highlight', 'pulse');
        arrows.forEach(arrow => {
          arrow.classList.add('flow');
          arrow.style.backgroundColor = '#86efac';
        });
      } else {
        // Switch back to render phase
        phase = 'render';
        phaseTitle.textContent = 'React Fiber Tree Animation (Render Phase)';
        phaseTitle.style.color = '#1e40af';
        infoBox.innerHTML =
          'ðŸ§© <b>Render Phase:</b> React walks the Fiber tree, preparing updates and diffing the virtual DOM.';
        infoBox.style.backgroundColor = 'white';

        nodes.forEach(node => {
          node.classList.remove('commit');
          node.classList.add('render');
        });

        animatedBox.classList.remove('highlight', 'pulse');
        arrows.forEach(arrow => {
          arrow.classList.remove('flow');
          arrow.style.backgroundColor = '#ccc';
        });
      }
    }, 3000);
  </script>
</body>
</html>
